{# Item cart Sextractor template #}

<table class="cleantd">
	<tr>
		<td style="width: 100%; padding: 3px">
			<div id="{{ plugin.id }}_{{ forloop.counter }}_selections_div"></div>
			<script type="text/javascript">
					{{ plugin.id }}.displayImageCount('{{ data.userData.imgList }}', '{{ plugin.id }}_{{ forloop.counter }}_selections_div');
			</script>
			<table class="plugin_small">
				{% if data.userData.flagPath %}
				<tr>
					<td><span class="regLetter">Flag:</span></td>
					<td>{{ data.userData.flagPath }}</td>
				</tr>
				{% endif %}
				{% if data.userData.weightPath %}
				<tr>
					<td><span class="regLetter">Weight:</span></td>
					<td>{{ data.userData.weightPath }}</td>
				</tr>
				{% endif %}

				{% if data.userData.psfPath %}
				<tr>
					<td><span class="regLetter">Psf:</span></td>
					<td>{{ data.userData.psfPath }}</td>
				</tr>
				{% endif %}
				<tr>
					<td><span class="confLetter">Config:</span></td>
					<td>{{ data.userData.config }}</td>
				</tr>
				<tr>
					<td><span class="confLetter">Results output dir:</span></td>
					<td>{{ data.userData.resultsOutputDir }}</td>
				</tr>
			</table>
			<div id="{{ plugin.id }}_images_div_{{ forloop.counter }}" style="display: none;"></div>
		</td>
		<td style="text-align: center; vertical-align: middle">
			<div class="submitItem">
				<p><img src="/media/themes/{{ user.get_profile.guistyle }}/img/48x48/{{ plugin.id }}.png" style="vertical-align:middle"/></p>
				<p><img id="{{ plugin.id }}_{{ forloop.counter}}_run" src="/media/themes/{{ user.get_profile.guistyle }}/img/misc/run.gif" title="Submit processing to cluster"/> 
				</p>
			</div>
			<div>or</div>
			<img id="{{ plugin.id }}_{{ forloop.counter}}_save" src="/media/themes/{{ user.get_profile.guistyle }}/img/misc/save_later.gif"/>
		</td>
	</tr>
</table>

<script type="text/javascript">
	document.observe('dom:loaded', function() {
		$('{{ plugin.id }}_{{ forloop.counter}}_run').observe('click', function() {
			{{ plugin.id }}.run('{{ plugin.id }}_{{ forloop.counter }}', {
				IdList:				'{{ data.userData.imgList }}', 
				ItemId: 			'{{ plugin.itemPrefix }}{{ data.itemCounter }}', 
				FlagPath: 			'{{ data.userData.flagPath }}',
				WeightPath: 		'{{ data.userData.weightPath }}',
				PsfPath: 			'{{ data.userData.psfPath }}',
				Config: 			'{{ data.userData.config }}',
				ResultsOutputDir: 	'{{ data.userData.resultsOutputDir }}',
			//	SwarpId: 			'{{ data.userData.swarpId }}',
			});
		});

		$('{{ plugin.id }}_{{ forloop.counter}}_save').observe('click', function() {
			{{ plugin.id }}.saveItemForLater('{{ plugin.id }}_{{ forloop.counter }}', {
				IdList: 			'{{ data.userData.imgList }}', 
				ItemID: 			'{{ plugin.itemPrefix }}{{ data.itemCounter }}', 
				FlagPath: 			'{{ data.userData.flagPath }}',
				WeightPath: 		'{{ data.userData.weightPath }}',
				PsfPath: 			'{{ data.userData.psfPath }}',
				ResultsOutputDir: 	'{{ data.userData.resultsOutputDir }}',
				Config: 			'{{ data.userData.config }}'
			});
		});
	});
</script>
