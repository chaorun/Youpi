
{# Sextractor template #}

<div style="text-align: center;">
		<div>
		<ul class="smart_tabnav_sub" id="menu">
			<li class="enabled">
				<a 	href="#" id="entry_0" 
					onclick="swap_display(this.id, 'menuitem_sub_0', 'menu', 'menuitem_sub_');">Select images</a>
			</li>
			<li class="disabled">
				<a 	href="#" id="entry_1" 
					onclick="swap_display(this.id, 'menuitem_sub_1', 'menu', 'menuitem_sub_');">Select data paths</a>
			</li>
			<li class="disabled">
				<a 	href="#" id="entry_2" 
					onclick="swap_display(this.id, 'menuitem_sub_2', 'menu', 'menuitem_sub_');">Select a configuration file</a>
			</li>
			<li class="disabled">
				<a 	href="#" id="entry_3" 
					onclick="swap_display(this.id, 'menuitem_sub_3', 'menu', 'menuitem_sub_'); document.getElementById('output_path_input').focus();">Set output directory</a>
			</li>
			<li class="disabled">
                <a  href="#" id="entry_4"
                        onclick="swap_display(this.id, 'menuitem_sub_4', 'menu', 'menuitem_sub_'); var d=document.getElementById('menuitem_sub_4'); d.innerHTML=getLoadingHTML('Loading cluster data, please wait');monitorJobs('menuitem_sub_4');">Sextractor job monitoring</a>
            </li>
		</ul>
		<div style="margin-right: 10px; margin-top: 10px; text-align: right;">
			<img style="cursor: pointer" src="/media/{{ user.get_profile.guistyle }}/img/misc/add_to_cart.gif" onclick="{{ plugin.id }}_addSelectionToCart();"/>
		</div>
		<div align="center" style="width: 100%" id="menuitem_sub_0"></div>
		<div align="center" style="display: none; width: 100%" id="menuitem_sub_1">
			<div id="selector_div"></div>
		</div>
		<div align="center" style="display: none; width: 100%" id="menuitem_sub_2">
			<div style="width: 500px" id="config_file_div"></div>
		</div>
		<div align="center" style="display: none; width: 100%" id="menuitem_sub_3"></div>
		<div align="center" style="display: none; width: 100%" id="menuitem_sub_4"></div>
	</div>
</div>

<script type="text/javascript">
	doit();

	var cf = new ConfigFileWidget('config_file_div', 'cf', '{{ plugin.id }}');

	fm_file_browser = new FileBrowser('{{ plugin.id }}_fbw_div', 'fm_file_browser');
	fm_file_browser.setRootTitle('Terapix Cluster');
	fm_file_browser.setFilteringPatterns(['*_flag.fits', '*_weight.fits']);
	fm_file_browser.setRootDataPath('/data');

	// Enable user output custom directory
	plugin_enableOutputDirectory('menuitem_sub_3', '{{ processing_output }}{{ user.username }}/{{ plugin.id }}/');

	var selector = new PathSelectorWidget('selector_div', 'selector', '{{ plugin.id }}');
	selector.addPath('FLAG data', 'flags');
	selector.addPath('WEIGHT data', 'weights');
	selector.addPath('PSF data', 'psf');
	selector.setFileBrowser(fm_file_browser);
	selector.render();

	// Now file browser can renders itself
	fm_file_browser.render();
</script>
