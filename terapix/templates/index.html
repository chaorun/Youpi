<HEAD></HEAD>
{% extends "base_site.html" %}
{% load i18n %}


{% block extrahead %}{{ block.super }}
<link rel="stylesheet" type="text/css" href="/media/themes/{{ user.get_profile.guistyle }}/css/menu.css"></script>
<script language="javascript" type="text/javascript" src="/media/js/javascript.js"></script>
<script type="text/javascript" src="/media/js/xhr.js"></script>
<script type="text/javascript" src="/media/js/common.js"></script>
<!-- Menu handling -->
<script type="text/javascript" src="/media/js/menu.js"></script>
<script type="text/javascript" src="/media/js/3rdParty/progressbar/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/media/js/3rdParty/progressbar/js/bramus/jsProgressBarHandler.js"></script>
<script type="text/javascript" src="/media/js/homeindex.js"></script>


<script type="text/javascript" src="/media/js/sqlform.js"></script>
<script type="text/javascript">
var guistyle = '{{ user.get_profile.guistyle }}';
</script>
{% endblock %}

{% block stylesheet %}/media/themes/{{ user.get_profile.guistyle }}/css/dashboard.css{% endblock %}
{% block coltype %}colMS{% endblock %}
{% block bodyclass %}dashboard{% endblock %}

{% block content %}
	<div id="pre_submenu">
		<ul class="smart_tabnav_sub" id="tabnav2">
			<li class="enabled"><a href="#" id="link_global" onclick="swap_display(this.id, 'menuitem_sub_0', 'tabnav2', 'menuitem_');">Global Informations</a></li>
		</ul>
	</div>
	<div id="menuitem_sub_0" style="margin-top: 40px;" align="center">
		<div align="center" class="homepage">
			<div id="survey">
				Please, add a survey :
				<input type="text" size="20" id="survey_input"></input>
				<input type="button" value="add !" id="add_survey_button" onclick="setup(this.parentNode.id);"></input>
				<div id="survey_log"></div>
			</div>
			<div id="instrument" style="display:none">
				Please, add an instrument :
				<input type="text" size="20" id="instrument_input"></input>
				<input type="button" value="add !" id="add_instrument_button" onclick="setup(this.parentNode.id);"></input>
				<div id="instrument_log"></div>
			</div>
			<div id="release" style="display:none">
				Please, add a release :
				<input type="text" size="20" id="release_input"></input>
				<input type="button" value="add !" id="add_release_button" onclick="setup(this.parentNode.id);"></input>
				<div id="release_log"></div>
			</div>
		</div>
	</div>
	

<script type="text/javascript">
function  setup(param) {

	var name = document.getElementById(param + '_input').value;
	var post = '';
	if (param == 'instrument') { 
		post += '&Survey=' + document.getElementById('survey_input').value;
	}
	else if(param == 'release') {
		post += '&Survey=' + document.getElementById('survey_input').value + '&Instrument=' + document.getElementById('instrument_input').value;
	}


    var xhr = new HttpRequest(
            null,
            null,   
            // Custom handler for results
            function(resp) {

				var log = new Logger(param + '_log');
				log.clear();
				if (resp['Error'].length) {
					log.msg_error(resp['Error']);
					return;
				}
				if (resp['Warning'].length) {
					log.msg_warning(resp['Warning']);
					return;
				}
				else {
					log.msg_ok('OK : '+ param + ' saved...');
					if (param == 'survey') {
						document.getElementById('instrument').setAttribute('style','display:block');
						}
					else if (param == 'instrument') {
						document.getElementById('release').setAttribute('style','display:block');
					}
				}
			}
    );

    post += '&Param=' + param + '&Value=' + name;
    xhr.send('/youpi/newindex/', post);
}
</script>

{% endblock %}
	
</body>
