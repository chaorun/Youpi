/*
 * Youpi's MCD graph
 *
 */
graph mcd { 
	labeldistance = 40.0;
	/* node [style=rounded] */

	/* Entities */
	node [shape=record];
	astro [label="{ Astrophotocalibration | [ Astrefcat ]\nXml path\nFlat field\nOutput zp }"];
	calib [label="{ Calibration Kit | [ Calibration Kit Id ]\nName\nBad pixel mask\nFlat field }"];
	cartitem [label="{ Cart Item | [ Cart Item Id ]\nName\nData }"];
	channel [label="{ Channel | [ Channel Id ]\nName\nWavelength\nUrl\nWavecurve\nTranscurve\nMag offsets }"];
	configfile [label="{ Config File | [ Config Id ]\nContent\nData }"];
	fitstables [label="{ FITS Tables | [ Name ]\nInstrument\nChannel\nRun\nQSO status\nObjet\nFitstable\nAbsorption\nAbsorption_err\nIs_phot }"];
	image [label="{ Image | [ Image Id ]\nName\nSky Footprint\nPath\nAlpha\nDelta\nEquinox\nObject\nDate Obs\nExp time\nPhotc Header\nPhotc Custom\nPhotk\nAirmass\nAbsorption\nChecksum\nGain\nIngestion date\nFlat\nMask\nReg\nQSO status }"];
	imageselections [label="{ Image selections | [ name ]\ndata }"];
	ingestion [label="{ Ingestion | [ Ingestion Id ]\nLabel\nEmail\nPath\nCheck fitsverify\nCheck QSO status\nCheck multiple ingestion\nExit code\nReport }"];
	instrument [label="{ Instrument | [ Instrument Id ]\nName\nTelescope\nUrl\nTimezone\nAltitude\nNchips\nAstrinstru key\nPhotinstru_key\nPath }"];
	miscdata [label="{ Misc data | [ Key ]\nData }"];
	run [label="{ Run | [ Name ]\nPI\nUrl\nEmail\nProcess request date\nDate start\nDate end\nDate download\nRelease date }"];
	survey [label="{ Survey | [ Name ]\nComment\nUrl}"];
	authuser [label="{ User | (Django table auth_user) }", style=dashed];
	task [label="{ Processing task | [ Id ]\nSuccess\nError Log\nHostname\nResults output directory\nTitle }"];
	processingkind [label="{ Processing kind | [ Internal name ]\nLabel }"];
	pluginfitsin [label="{ FITSin plugin | [ Id ]\nAstoffra\nAstoffde\nAststdevra\nAststdevde\nAstrom accuracy\nPsfwhm min\nPsfwhm\nPsfwhm max\nPsfhld min\nPsfhld\nPsfhld max\nPsfel min\nPsfel\nPsfel max\nPsfchi2 min\nPsfchi2\nPsfchi2 max\nPsfresi min\nPsfresi\nPsfresi max\nPsfasym min\nPsfasym\nPsfasym max\nNstars min\nNstars\nNstars max\nBkg\nBkgstdev\nSatlev\nFlat Path\nMask Path\nRegion Path\nQualityFITS config\nResults Ingestion Log\nHTTP Url\nPrevious Release Grade\nPrevious Release Comment }"];
	pluginfitsout [label="{ FITSout plugin | [ Id ] }"];
	pluginscamp [label="{ SCAMP plugin | [ Id ]\nConfig\nResults Ingestion Log\nHTTP Url\nLDAC Files\nThumbnails }"];
	pluginother [label="{ Other plugin | [ Id ]\n... }",style=dotted];
	firstqcomment [label="{ First Quality Comment | [ Comment ]}"];
	finalqcomment [label="{ Final Quality Comment | [ Comment ]}"];
	siteprofile [label="{ Site profile | [ Profile Id ]\nGUI Style}"];
	condornodesel [label="{ Condor Selections | [ Sel Id ]\nLabel\nNode selection}"];

	/* Relations */
	node [shape=ellipse];
	node4 [label="belongs to"];
	node5 [label="belongs to"];
	node6 [label="is part of"];
	node7 [label="belongs to"];
	node8 [label="belongs to"];
	node10 [label="coaddition"];
	node11 [label="belongs to"];
	node12 [label="observed through"];
	node13 [label="processed with"];
	node14 [label="is captured by"];
	node15 [label="{ is run by | Start Time\nEnd Time}", style=dashed, shape=Mrecord];
	node17 [label="is processed by"];
	node18 [label="{ is initiated by | Start Time\nEnd Time}", style=dashed, shape=Mrecord];
	node19 [label="kind"];
	node21 [label="belongs to"];
	node22 [label="{ belongs to | Creation Date}", style=dashed, shape=Mrecord];
	node23 [label="processing results"];
	node24 [label="{ first quality evaluation | Creation Date\nGrade\nCustom Comment }", style=dashed, shape=Mrecord];
	node25 [label="{ final quality evaluation | Creation Date\nGrade\nCustom Comment }", style=dashed, shape=Mrecord];
	node26 [label="predefined comments"];
	node27 [label="predefined comments"];
	node28 [label="has profile", style=dashed, shape=Mrecord];
	node29 [label="defines", style=dashed, shape=Mrecord];

	/* Links */
	run -- node4 [label="  1,n"];
	node4 -- image [label="  1,n"]; 

	instrument -- node5 [label="  0,n"]; 
	node5 -- run [label="  1,1"]; 

	instrument -- node6 [label="  1,n"];
	node6 -- survey [label="  1,n"];

	image -- node7 [label="  1,1"];
	node7 -- ingestion [label="  0,n"];

	channel -- node8 [label="  1,1"];
	node8 -- instrument [label="  0,n"];

	image -- node10 [label="  0,n"];
	node10 -- image [label="  1,n"];

	image -- node11 [label="  0,n"];
	node11 -- astro [label="  1,n"];

	image -- node12 [label="  1,1"];
	node12 -- channel [label="  1,n"];

	image -- node13 [label="  0,1"];
	node13 -- calib [label="  1,n"];

	task -- node23 [label="  0,n"];
	node23 -- pluginfitsin [label="  1,1"];
	node23 -- pluginfitsout [label="  1,1"];
	node23 -- pluginscamp [label="  1,1"];
	node23 -- pluginother [label="  1,1", style=dotted];

	siteprofile -- node28 [label="  1, 1"];
	authuser -- node28 [label="  0,1", style=dashed];

	condornodesel -- node29 [label="  1,1"];
	authuser -- node29 [label="  0,n", style=dashed];

	image -- node14 [label="  1,1"];
	node14 -- instrument [label="  0,n"];

	ingestion -- node15 [label="  1,1", style=dashed];
	node15 -- authuser [label="  0,n", style=dashed];

	cartitem -- node22 [label="  1,1", style=dashed];
	cartitem -- node21 [label="  1,1"];

	image -- node17 [label="  0,n"];
	node17 -- task [label="  0,n"];

	authuser -- node18 [label="  0,n", style=dashed];
	node18 -- task [label="  1,1", style=dashed];

	task -- node19 [label="  1,1"];
	node19 -- processingkind [label="  0,n"];

	configfile -- node21 [label="  1,1"];
	node21 -- processingkind [label="  0,n"];

	configfile -- node22 [label="  1,1", style=dashed];
	imageselections -- node22 [label="  1,1", style=dashed];
	miscdata -- node22 [label="  1,1", style=dashed];
	node22 -- authuser [label="  0,n", style=dashed];

	authuser -- node24 [label="  0,n", style=dashed];
	node24 -- pluginfitsin [label="  0,n", style=dashed];

	authuser -- node25 [label="  0,n", style=dashed];
	node25 -- pluginfitsout [label="  0,n", style=dashed];

	node24 -- node26 [label="  1,1"];
	node26 -- firstqcomment [label="  0,n"];

	node25 -- node27 [label="  1,1"];
	node27 -- finalqcomment [label="  0,n"];

} 
